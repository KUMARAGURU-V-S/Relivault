<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ReliefFund Events Dashboard</title>
</head>
<body>
  <h1>📊 ReliefFund Events</h1>
  <ul id="events"></ul>

  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script>
    const provider = new ethers.providers.JsonRpcProvider("http://127.0.0.1:8545");

    // ✅ Replace with your deployed contract address
    const contractAddress = "0x5FbDB2315678afecb367f032d93F642f64180aa3";

    // ✅ Minimal ABI with event definitions
    const abi = [
      "event DonationReceived(address indexed donor, uint256 amount, bool nftIssued)",
      "event ClaimSubmitted(uint256 indexed claimId, address indexed claimant, uint256 amount, string documentCID)",
      "event ClaimApproved(uint256 indexed claimId, address indexed claimant, uint256 amount)",
      "event ClaimRejected(uint256 indexed claimId, address indexed claimant, string reason)"
    ];

    const contract = new ethers.Contract(contractAddress, abi, provider);
    const list = document.getElementById("events");

    function addEvent(msg) {
      const li = document.createElement("li");
      li.textContent = msg;
      list.appendChild(li);
    }

    // Listen to events
    contract.on("DonationReceived", (donor, amount, nftIssued) => {
      addEvent(`💰 Donation from ${donor} of ${ethers.utils.formatEther(amount)} ETH (NFT: ${nftIssued})`);
    });

    contract.on("ClaimSubmitted", (claimId, claimant, amount, docCID) => {
      addEvent(`📝 Claim #${claimId} submitted by ${claimant} for ${ethers.utils.formatEther(amount)} ETH (doc: ${docCID})`);
    });

    contract.on("ClaimApproved", (claimId, claimant, amount) => {
      addEvent(`✅ Claim #${claimId} approved for ${claimant}, amount: ${ethers.utils.formatEther(amount)} ETH`);
    });

    contract.on("ClaimRejected", (claimId, claimant, reason) => {
      addEvent(`❌ Claim #${claimId} rejected for ${claimant}, reason: ${reason}`);
    });
  </script>
</body>
</html>
